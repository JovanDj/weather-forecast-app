<section class="weather-form">
  <form
    [formGroup]="weatherForm"
    (ngSubmit)="getCurrentWeather(weatherForm.value)"
    novalidate
    autocomplete="off"
    fxLayout="column"
  >
    <mat-form-field>
      <mat-label>Enter City name to continue</mat-label>

      <input
        matInput
        (keyup)="getCityOptions(weatherForm.value)"
        formControlName="q"
        type="text"
        id="city_name"
        placeholder="City name"
        [matAutocomplete]="auto"
      />

      <mat-autocomplete
        #auto="matAutocomplete"
        (optionSelected)="selectCity($event.option.value)"
      >
        <mat-option
          id="cities"
          *ngFor="let city of (cityOptions$ | async)"
          [value]="city.name"
        >
          {{ city.name }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <ng-container>
      <button
        mat-raised-button
        color="primary"
        [disabled]="weatherForm.invalid"
        type="submit"
        class="weather-btn"
      >
        Submit
      </button>
      <button
        *ngIf="!watchID"
        mat-raised-button
        matTooltip="Use your devices GPS to track your location realtime."
        color="primary"
        type="button"
        matRipple
        (click)="getCoords()"
      >
        Detect location
      </button>
      <button
        *ngIf="watchID"
        type="button"
        mat-raised-button
        matRipple
        matTooltip="Disable realtime GPS tracking."
        color="primary"
        (click)="clearWatch()"
      >
        Stop Tracking
      </button>
    </ng-container>

    <div *ngIf="errorMessage" (click)="errorMessage = ''">
      {{ errorMessage }}
    </div>
  </form>
</section>

<mat-spinner *ngIf="loading"></mat-spinner>
